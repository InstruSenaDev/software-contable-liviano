import"./hoisted.ll0w3Ecl.js";document.addEventListener("DOMContentLoaded",function(){l("nombres","name-error"),l("apellidos","lastName-error"),l("correo","email-error"),m(),document.getElementById("guardar-cambios").addEventListener("click",function(){d("nombres",document.getElementById("input-nombres").value),d("apellidos",document.getElementById("input-apellidos").value),d("correo",document.getElementById("input-correo").value)});function l(e,n){const o=document.getElementById(`input-${e}`),r=document.getElementById(`edit-${e}`),t=document.getElementById(`save-${e}`),a=document.getElementById(`cancel-${e}`),s=document.getElementById(n);let c;if(!o||!r||!t||!a||!s){console.error(`No se encontró uno de los elementos para el campo ${e}.`);return}r.addEventListener("click",function(){c=o.value,o.value="",o.disabled=!1,r.classList.add("hidden"),t.classList.remove("hidden"),a.classList.remove("hidden")}),a.addEventListener("click",function(){o.disabled=!0,o.value=c,s.textContent="",r.classList.remove("hidden"),t.classList.add("hidden"),a.classList.add("hidden")}),t.addEventListener("click",function(){const g=o.value.trim();u(e,g,s)&&(o.disabled=!0,r.classList.remove("hidden"),t.classList.add("hidden"),a.classList.add("hidden"),s.textContent="")})}function u(e,n,o){let r,t="";if(n==="")t=`El campo ${e} no puede estar vacío.`;else switch(e){case"nombres":case"apellidos":r=/^[a-zA-Z\s]+$/,r.test(n)||(t=`El campo ${e} solo puede contener letras y espacios.`);break;case"correo":r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,r.test(n)||(t=`El campo ${e} debe ser un correo electrónico válido.`);break;default:return!1}return t?(o.textContent=t,!1):!0}function m(){const e=localStorage.getItem("email");if(!e){console.error("Correo del usuario no encontrado en localStorage.");return}fetch(`http://localhost:8080/usuariosLog?email=${encodeURIComponent(e)}`).then(n=>{if(!n.ok)throw new Error("Error al obtener los datos del usuario.");return n.json()}).then(n=>{if(n.length>0){const o=n[0];document.getElementById("input-nombres").value=o.nombre||"",document.getElementById("input-apellidos").value=o.apellido||"",document.getElementById("input-correo").value=o.correo||""}else console.log("Usuario no encontrado.")}).catch(n=>{console.error("Error al realizar la solicitud:",n.message)})}function E(){const e=document.getElementById("modal-editexitoso");e.classList.remove("hidden"),setTimeout(()=>{e.classList.add("hidden")},3e3)}function i(){const e=document.getElementById("modal-erroredit");e.classList.remove("hidden"),setTimeout(()=>{e.classList.add("hidden")},3e3)}function d(e,n){const o=localStorage.getItem("email");if(!o){console.error("Correo del usuario no encontrado en localStorage.");return}const r={[e]:n,email:o};fetch("http://localhost:8080/actualizarPerfil",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(t=>{if(!t.ok)throw i(),new Error("Error al actualizar los datos.");return t.json()}).then(t=>{console.log("Datos actualizados exitosamente:",t),localStorage.setItem(e,n),E()}).catch(t=>{console.error("Error al actualizar los datos:",t.message),i()})}});
